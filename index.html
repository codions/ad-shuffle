<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotação de Banners</title>

    <style>
        .codions-random-ads {
            background-image: url(/assets/images/vectorline.jpg);
            background-position: center center;
            background-repeat: repeat;
            background-size: 13%;
            height: auto !important;
            width: 100%;
            text-align: center;
            font-family: sans-serif;
            margin-top: 1.25rem;
            border: 1px solid #f3f4f6;
            padding: 0.5rem;
            border-radius: 0.75rem;
            display: none;
        }

        .codions-random-ads .ads-info {
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.5rem;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const adsContainers = document.querySelectorAll('.codions-ads');
            const currentDateTime = new Date();

            adsContainers.forEach(adsContainer => {
                const ads = adsContainer.querySelectorAll('.codions-random-ads');
                const weightedAds = [];
                let totalWeight = 0;

                ads.forEach(ad => {
                    const startDate = ad.getAttribute('data-start-date') ? new Date(ad.getAttribute('data-start-date')) : null;
                    const endDate = ad.getAttribute('data-end-date') ? new Date(ad.getAttribute('data-end-date')) : null;

                    if ((startDate && currentDateTime < startDate) || (endDate && currentDateTime > endDate)) {
                        return; // Skip this ad if it's outside the valid date range
                    }

                    const frequency = parseInt(ad.getAttribute('data-frequency')) || 1;
                    totalWeight += frequency;
                    for (let i = 0; i < frequency; i++) {
                        weightedAds.push(ad);
                    }
                });

                if (weightedAds.length === 0) {
                    return; // No ads to display
                }

                const randomIndex = Math.floor(Math.random() * totalWeight);
                const selectedAd = weightedAds[randomIndex];

                ads.forEach(ad => {
                    ad.style.display = 'none';
                });

                selectedAd.style.display = 'block';
            });
        });
    </script>
</head>
<body>
    <div class="codions-ads">
        <div class="codions-random-ads" data-frequency="50" data-start-date="2024-08-02 12:35:00" data-end-date="2024-08-02 12:43:00">
            <div class="ads-info">Publicidade</div>
            Banner 1 - Frequência 50% (2024-08-02 12:35:00 - 2024-08-02 12:43:00)
        </div>
        <div class="codions-random-ads" data-frequency="25" data-end-date="2024-08-02 13:00:00">
            <div class="ads-info">Publicidade</div>
            Banner 2 - Frequência 25% (End 2024-08-02 13:00:00)
        </div>
        <div class="codions-random-ads" data-frequency="25" data-start-date="2024-08-01 00:00:00">
            <div class="ads-info">Publicidade</div>
            Banner 3 - Frequência 25% (Start 2024-08-01 00:00:00)
        </div>
    </div>

    <div class="codions-ads">
        <div class="codions-random-ads" data-frequency="25" data-start-date="2024-08-03 00:00:00">
            <div class="ads-info">Publicidade</div>
            Banner 4 - Frequência 25% (Start 2024-08-03 00:00:00)
        </div>
        <div class="codions-random-ads" data-frequency="75">
            <div class="ads-info">Publicidade</div>
            Banner 5 - Frequência 75%
        </div>
    </div>

    <div class="codions-ads">
        <div class="codions-random-ads" data-frequency="33">
            <div class="ads-info">Publicidade</div>
            Banner 6 - Frequência 33%
        </div>
        <div class="codions-random-ads" data-frequency="33">
            <div class="ads-info">Publicidade</div>
            Banner 7 - Frequência 33%
        </div>
        <div class="codions-random-ads" data-frequency="33">
            <div class="ads-info">Publicidade</div>
            Banner 8 - Frequência 33%
        </div>
    </div>
</body>
</html>
